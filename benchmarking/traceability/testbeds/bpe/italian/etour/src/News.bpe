▁ ï»¿ p ackage ▁unisa . gps . etour . gui . operatoreagenzia ; ▁import ▁java . awt ▁ .* ; ▁import ▁java . awt . event ▁ .* ; ▁import ▁java . io . File N otFoundException ; ▁import ▁java . rmi . RemoteException ; ▁import ▁java . rmi . registry . LocateRegistry ; ▁import ▁java . rmi . registry . Registry ; ▁import ▁java . util . ArrayList ; ▁import ▁java . util . Date ; ▁import ▁java x . swing ▁ .* ; ▁import ▁java . util ▁ .* ; ▁import ▁java x . swing . text . Ba d Location Exception ; ▁import ▁java x . swing . text . Document ; ▁import ▁java x . swing . border ▁ .* ; ▁import ▁unisa . gps . etour . bean . BeanNews ; ▁import ▁unisa . gps . etour . control . Gestione Advertisement . IGestioneAdve rtisementAgenzia ; ▁import ▁unisa . gps . etour . gui . DeskManager ; ▁import ▁unisa . gps . etour . gui . HelpManager ; ▁import ▁unisa . gps . etour . gui . operatoreagenzia . document . LimitedDocument ; ▁import ▁unisa . gps . etour . gui . operatoreagenzia . tables . NewsTableModel ; ▁import ▁unisa . gps . etour . gui . operatoreagenzia . tables . PrioritaRenderer ; ▁import ▁unisa . gps . etour . gui . operatoreagenzia . tables . ScrollableTable ; ▁import ▁unisa . gps . etour . gui . operatoreagenzia . tables . T estoNewsRenderer ; ▁import ▁unisa . gps . etour . util . Data ; ▁/ ▁** ▁* ▁ This ▁class ▁implements ▁the ▁interface ▁for ▁collec ting ▁news ▁for ▁the ▁ act or ▁* ▁Operator ▁Agency . ▁* ▁* ▁@ ▁Version ▁1.0 ▁* ▁@ ▁Auth or ▁M ario ▁Ga llo ▁* ▁* ▁ Â© ▁ 2007 ▁eTour ▁Project ▁- ▁Copy right ▁by ▁DMI ▁SE ▁@ ▁ SA ▁Lab ▁-- ▁* ▁University ▁of ▁Salerno ▁* ▁/ ▁public ▁class ▁News ▁ext ends ▁JInternalFrame ▁( ▁private ▁JPanel ▁jContentPane ▁= ▁null ; ▁P rivate ▁JToolBar ▁NewsToolbar ▁= ▁null ; ▁private ▁JButton ▁btnEliminaN ▁= ▁null ; ▁private ▁JPanel ▁rightPanel ▁= ▁null ; ▁private ▁JPanel ▁formNews ▁= ▁null ; ▁P rivate ▁ JSlider ▁prSlider ▁= ▁null ; ▁private ▁JButton ▁btnInsertModify ▁= ▁null ; ▁private ▁JButton ▁btnReset ▁= ▁null ; ▁private ▁JPanel ▁panelHelp ▁= ▁null ; ▁private ▁ JTextPane ▁textGuida ▁= ▁null ; ▁private ▁JScrollPane ▁scrollTableNews ▁= ▁null ; ▁private ▁JTable ▁tableNews ▁= ▁null ; ▁private ▁JTextArea ▁testoNews ▁= ▁null ; ▁private ▁JComboBox ▁durataNews ▁= ▁null ; ▁private ▁JButton ▁btnModificaN ▁= ▁null ; ▁private ▁JLabel ▁labelCaratteri ; ▁private ▁int ▁idNews ▁= ▁ -1; ▁private ▁NewsTableModel ▁TableModel ; ▁P rivate ▁ HelpManager ▁ newsHelp ; ▁prot ected ▁DeskManager ▁desktopManager ; ▁prot ected ▁JDesktopPane ▁JDesktopPane ; ▁P rivate ▁IGestioneAdve rtisementAgenzia ▁gestioneNews ; ▁/ ▁** ▁* ▁ This ▁is ▁the ▁default ▁constructor . ▁* ▁/ ▁public ▁News ▁() ▁( ▁super ▁( ▁" News "); ▁ setPreferredSize ▁( Home . CHI LD _ SIZE ); ▁ setMinimum Size ▁( new ▁Dimension ▁( 600 , ▁480) ); ▁s etRes izable ▁( true ); ▁ setF rameIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" News 32. png ▁ "))); ▁se tIconifi able ▁( true ); ▁ setMaxim izable ▁( true ); ▁set Clos able ▁( true ); ▁/ ▁/ ▁Set ting ▁up ▁dell ' help ▁manager ▁to ▁manage ▁the ▁news . ▁textGuida ▁= ▁new ▁ JTextPane ▁(); ▁TR Y ▁( ▁ newsHelp ▁= ▁new ▁ HelpManager ▁( Home . URL _ HE L P ▁+ ▁" new s . txt " ▁textGuida ); ▁) ▁catch ▁( File N otFoundException ▁e ) ▁( ▁textGuida ▁ . ▁setText ▁( ▁"< html > ▁< b > ▁Help ▁not ▁ava i lable ▁</ ▁b > ▁</ ▁html > "); ▁) ▁set ContentPane ▁( getJ ContentPane ▁()); ▁add InternalFrame Listener ▁( new ▁ InternalFrame Adapter ▁() ▁( ▁/ ▁* ▁* ▁I nclusion ▁of ▁the ▁frame ▁on ▁the ▁desktop ▁desktop ▁retrieve s ▁bread ▁bread ▁* ▁And ▁desktop ▁manager ▁and ▁initialize s ▁the ▁remote ▁objects ▁* ▁Management ▁of ▁cultural ▁heritage . ▁* ▁/ ▁public ▁void ▁internalFrame Open ed ▁( InternalFrame Event ▁pEvent ) ▁( ▁P Event . get InternalFrame ▁JInternalFrame ▁frame ▁= ▁(); ▁JDesktopPane ▁frame . get DesktopPane ▁= ▁(); ▁desktopManager ▁= ▁( DeskManager ) ▁j DesktopPane . get DesktopManager ▁(); ▁/ ▁/ ▁Set ting ▁up ▁objects ▁for ▁remote ▁asset ▁management ▁/ ▁/ ▁Cultural . ▁TR Y ▁( ▁ Registry ▁reg ▁= ▁ LocateRegistry . get Registry ▁( Home . HO ST ); ▁gestioneNews ▁= ▁( IGestioneAdve rtisementAgenzia ) ▁reg ▁ . ▁look up ▁( ▁" GestioneAdve rtisementAgenzia "); ▁/ ▁/ ▁Load ▁data . ▁carica Tabella ▁(); ▁) ▁/ ▁* ▁* ▁T wo ▁exceptions : ▁RemoteException ▁and ▁ NotB oundException . ▁The ▁* ▁Result ▁is ▁the ▁same . ▁The ▁management ▁is ▁not ▁opera ble ▁and ▁* ▁ After ▁the ▁error ▁message ▁window ▁closes . ▁* ▁/ ▁catch ▁( Exception ▁ex ) ▁( ▁JLabel ▁error ▁= ▁new ▁JLabel ▁( ▁"< html > ▁< h 2> ▁Un able ▁to ▁communicat e ▁with ▁the ▁server ▁eTour . ▁</ ▁h 2 >" ▁+ ▁"< h 3> ▁< u > ▁The ▁dialog ▁management ▁request ▁is ▁closed . ▁</ ▁U > ▁</ ▁h 3 >" ▁+ ▁"< p > ▁< b > ▁P ossible ▁C aus es : ▁</ ▁b >" ▁+ ▁"< ul > ▁< li > ▁No ▁connection ▁to ▁the ▁ne t work . ▁</ ▁Li >" ▁+ ▁" Server ▁< li > ▁inactive . ▁</ ▁Li >" ▁+ ▁" Server ▁< li > ▁c logged . ▁</ ▁Li > ▁</ ▁ul >" ▁+ ▁"< p > ▁P lease ▁try ▁again ▁later . ▁</ ▁P >" ▁+ ▁"< p > ▁I f ▁the ▁error ▁ persist s , ▁p lease ▁conta ct ▁te ch n ical ▁support . ▁</ ▁P >" ▁+ ▁"< p > ▁We ▁a pologi ze ▁for ▁the ▁in convenien ce . ▁</ ▁H tml > "); ▁Err ▁= ▁new ▁ImageIcon ▁ImageIcon ▁( getClass ▁() . ▁GetRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" error 48 . png ") ); ▁JOptionPane . show MessageDialog ▁( JDesktopPane , ▁error , ▁" Error !" ▁JOptionPane . ERROR _ MESSAGE , ▁err ); ▁frame . dispose ▁(); ▁) ▁) ▁) ); ▁) ▁/ ▁** ▁* ▁Initializ e ▁the ▁content ▁pane ▁of ▁the ▁frame ▁inside . ▁* ▁* ▁@ ▁Return ▁java x . swing . JPanel ▁- ▁the ▁content ▁pane . ▁* ▁/ ▁private ▁JPanel ▁getJ ContentPane ▁() ▁( ▁if ▁( null ▁== ▁jContentPane ) ▁( ▁jContentPane ▁= ▁new ▁JPanel ▁(); ▁jContentPane . setLayout ▁( new ▁BorderLayout ▁()); ▁jContentPane . add ▁( get NewsToolbar ▁(), ▁BorderLayout . NORTH ); ▁jContentPane . add ▁( get RightPanel ▁(), ▁BorderLayout . EAST ); ▁jContentPane . add ▁( get TableNews ▁(), ▁BorderLayout . CENTER ); ▁) ▁jContentPane ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁toolbar ▁to ▁manage ▁the ▁news . ▁* ▁* ▁@ ▁Return ▁java x . swing . JToolBar ▁- ▁the ▁toolbar ▁management ▁news . ▁* ▁/ ▁P rivate ▁JToolBar ▁get NewsToolbar ▁() ▁( ▁if ▁( null ▁== ▁NewsToolbar ) ▁( ▁NewsToolbar ▁JToolBar ▁= ▁new ▁(); ▁NewsToolbar . set Float able ▁( false ); ▁NewsToolbar . add ▁( getBtnModifica N ▁()); ▁NewsToolbar . addS eparator ▁(); ▁NewsToolbar . add ▁( getBtnElimina N ▁()); ▁) ▁NewsToolbar ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁button ▁to ▁edit ▁a ▁news . ▁* ▁* ▁@ ▁Return ▁java x . swing . JButton ▁- ▁button ▁to ▁change . ▁* ▁/ ▁private ▁JButton ▁getBtnModifica N ▁() ▁( ▁if ▁( null ▁== ▁btnModificaN ) ▁( ▁btnModificaN ▁= ▁new ▁JButton ▁(); ▁btnModificaN . setText ▁( ▁" Edit ▁News "); ▁btnModificaN . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" ModificaNews 32. png ▁ "))); ▁btnModificaN . set Cursor ▁( Cursor ▁ . ▁getP redefined Cursor ▁( Cursor . H AND _ CU RSO R )); ▁btnModificaN . setName ▁( btnModifica ▁"); ▁btnModificaN . addMouse Listener ▁( newsHelp ); ▁btnModificaN . setEnabled ▁( false ); ▁btnModificaN . a ddActionListener ▁( new ▁ActionListener ▁() ▁( ▁public ▁void ▁actionPerformed ▁( ActionEvent ▁p ActionEvent ) ▁( ▁int ▁selectedRow ▁= ▁tableNews . getS electedRow ▁(); ▁if ▁( idNews ▁== ▁-1) ▁/ ▁/ ▁In ▁this ▁ way ▁I ▁know ▁if ▁sh e ▁was ▁/ ▁/ ▁Edit ▁( ▁btnInsertModify . setText ▁( ▁" Change "); ▁btnInsertModify . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() ▁ . ▁getRe source ▁( Home . URL _ IMAGES ▁+ ▁" Salva 16. png ▁ "))); ▁btnReset . setText ▁( ▁" Cancel "); ▁btnReset . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" Annulla 16. png ▁ "))); ▁formNews . set Border ▁( BorderFactory . create TitledBorder ▁( ▁ BorderFactory . create Line Border ▁( new ▁Color ▁(51, ▁102, ▁255) , ▁3), ▁" Edit ▁News " ▁ TitledBorder . DEF A ULT _ JUSTIF ICA TION , ▁ TitledBorder . DEF A ULT _ POS I TION , ▁new ▁Font ▁( ▁" Dialog ", ▁Font . BOLD , ▁12), ▁new ▁Color ▁(0, ▁102, ▁ 204 ))); ▁) ▁String ▁text ▁= ▁( String ) ▁table Model . get ValueAt ▁( selectedRow , ▁0) ; ▁numCaratteri ▁int ▁= ▁200 ▁- ▁testo . length ▁() ▁+ ▁1; ▁labelCaratteri . setText ▁( ▁" # ▁Characters :" ▁+ ▁numCaratteri ); ▁ Document ▁testoNews . get Document ▁ doc test ▁= ▁(); ▁TR Y ▁( ▁ doc Testo . remove ▁(0, ▁ doc Testo . get Length ▁()); ▁ doc Testo . insert String ▁(0, ▁text , ▁null ); ▁) ▁catch ▁( Ba d Location Exception ▁s ) ▁( ▁e . printStackTrace ▁(); ▁) ▁Expir y ▁date ▁= ▁( Date ) ▁TableModel ▁ . ▁get ValueAt ▁( selectedRow , ▁3 ); ▁durataNews . s etSelectedIndex ▁( Data . getNum Day s ▁( expires )); ▁idNews ▁= ▁table Model . getID ▁( selectedRow ); ▁prSlider . setValue ▁( ( Integer ) ▁table Model . get ValueAt ▁( ▁selectedRow , ▁1) ); ▁) ▁) ); ▁) ▁btnModificaN ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁button ▁to ▁delete ▁a ▁news . ▁* ▁* ▁@ ▁Return ▁java x . swing . JButton ▁- ▁the ▁button ▁for ▁deletion . ▁* ▁/ ▁private ▁JButton ▁getBtnElimina N ▁() ▁( ▁if ▁( null ▁== ▁btnEliminaN ) ▁( ▁btnEliminaN ▁= ▁new ▁JButton ▁(); ▁btnEliminaN . setText ▁( ▁" Delete ▁News "); ▁btnEliminaN . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" EliminaNews 32. png ▁ "))); ▁btnEliminaN . setEnabled ▁( false ); ▁btnEliminaN . set Cursor ▁( Cursor ▁ . ▁getP redefined Cursor ▁( Cursor . H AND _ CU RSO R )); ▁btnEliminaN . setName ▁( btnElimina ▁"); ▁btnEliminaN . addMouse Listener ▁( newsHelp ); ▁btnEliminaN . a ddActionListener ▁( new ▁ActionListener ▁() ▁( ▁public ▁void ▁actionPerformed ▁( ActionEvent ▁pEvent ) ▁( ▁int ▁selectedRow ▁= ▁tableNews . getS electedRow ▁(); ▁/ ▁/ ▁Construct ion ▁of ▁the ▁dialog ▁for ▁confirmation ▁/ ▁/ ▁Elimina tion ▁Root ▁= ▁new ▁JPanel ▁JPanel ▁( new ▁BorderLayout ▁()); ▁JLabel ▁message ▁= ▁new ▁JLabel ▁( ▁" Are ▁you ▁ sure ▁you ▁want ▁to ▁delete ▁the ▁selected ▁news ? "); ▁message . setFont ▁( new ▁Font ▁( ▁" Dialog ", ▁Font . BOLD , ▁14)) ; ▁JLabel ▁alert ▁= ▁new ▁JLabel ▁( ▁" The ▁deleted ▁data ▁can ▁not ▁be ▁ fill ed ▁again . " ▁ SwingConstants . CENTER ); ▁avvis o . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" warning 16. png ▁ "))); ▁root . add ▁( message , ▁BorderLayout . NORTH ); ▁root . add ▁( n otice , ▁BorderLayout . CENTER ); ▁String ▁[] ▁options ▁= ▁( ▁" Delete ", ▁" Cancel "); ▁/ ▁/ ▁The ▁dialog ▁screen ▁appear s ▁int ▁choice ▁= ▁JOptionPane . showInternal Option Dialog ▁( ▁jContentPane , ▁root , ▁" Confirm ▁Delete ▁News " ▁JOptionPane . YES _ NO _ OPTION , ▁JOptionPane . QU ESTION _ MESSAGE , ▁new ▁ImageIcon ▁( ▁getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" EliminaNews 48 . png ")), ▁options , ▁options ▁[1] ); ▁/ ▁/ ▁I f ▁you ▁chose ▁to ▁confirm ▁the ▁deletion ▁if ▁( choice ▁== ▁JOptionPane . YES _ OPTION ) ▁( ▁TR Y ▁( ▁gestioneNews . cancella News ▁( TableModel ▁ . ▁getID ▁( selectedRow )); ▁table Model . remove News ▁( selectedRow ); ▁JOptionPane ▁ . ▁showInternal MessageDialog ▁( ▁jContentPane , ▁" The ▁news ▁has ▁be en ▁selected ▁successfully ▁deleted " ▁" News ▁out !" ▁JOptionPane . OK _ OPTION , ▁new ▁ImageIcon ▁( ▁getClass ▁() ▁ . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" Ok 48 . png ▁ "))); ▁azzera Form ▁(); ▁) ▁catch ▁( Exception ▁ex ) ▁( ▁JLabel ▁error ▁= ▁new ▁JLabel ▁( ▁"< html > ▁< h 2> ▁Un able ▁to ▁communicat e ▁with ▁the ▁server ▁eTour . ▁</ ▁h 2 >" ▁+ ▁"< h 3> ▁< u > ▁Delete ▁operation ▁request ▁can ▁not ▁be ▁completed . ▁</ ▁U > ▁</ ▁h 3 >" ▁+ ▁"< p > ▁P lease ▁try ▁again ▁later . ▁</ ▁P >" ▁+ ▁"< p > ▁I f ▁the ▁error ▁ persist s , ▁p lease ▁conta ct ▁te ch n ical ▁support . ▁</ ▁P >" ▁+ ▁"< p > ▁We ▁a pologi ze ▁for ▁the ▁in convenien ce . ▁</ ▁H tml > "); ▁Err ▁= ▁new ▁ImageIcon ▁ImageIcon ▁( getClass ▁() ▁ . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" error 48 . png ") ); ▁JOptionPane . show MessageDialog ▁( JDesktopPane , ▁error , ▁" Error !" ▁JOptionPane . ERROR _ MESSAGE , ▁err ); ▁) ▁) ▁) ▁) ); ▁) ▁btnEliminaN ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁panel ▁that ▁realiz es ▁the ▁interface ▁side ▁* ▁Right ▁of ▁news ▁management . ▁* ▁* ▁@ ▁Return ▁java x . swing . JPanel ▁- ▁the ▁right ▁panel . ▁* ▁/ ▁private ▁JPanel ▁get RightPanel ▁() ▁( ▁if ▁( null ▁== ▁rightPanel ) ▁( ▁rightPanel ▁= ▁new ▁JPanel ▁(); ▁rightPanel . setLayout ▁( new ▁GridBagLayout ▁()); ▁Grid BagConstraints ▁g ▁= ▁new ▁Grid BagConstraints ▁(); ▁g . fill ▁= ▁Grid BagConstraints . BOTH ; ▁g . gridx ▁= ▁0; ▁g . grid y ▁= ▁0; ▁g . weight y ▁= ▁0. 7; ▁rightPanel . add ▁( get Form News ▁(), ▁g ); ▁g . weight y ▁= ▁0.3 ; ▁g . grid y ▁= ▁1; ▁rightPanel . add ▁( get PanelHelp ▁(), ▁g ); ▁) ▁rightPanel ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁form ▁for ▁entering ▁and ▁editing ▁a ▁* ▁News . ▁* ▁* ▁@ ▁Return ▁java x . swing . JPanel ▁- ▁the ▁format ▁* ▁/ ▁private ▁JPanel ▁get Form News ▁() ▁( ▁if ▁( null ▁== ▁formNews ) ▁( ▁formNews ▁= ▁new ▁JPanel ▁( new ▁GridBagLayout ▁()); ▁formNews . set Border ▁( BorderFactory . create TitledBorder ▁( BorderFactory ▁ . ▁create Line Border ▁( new ▁Color ▁(51, ▁102, ▁255) , ▁3), ▁" New ▁News ", ▁ TitledBorder . DEF A ULT _ JUSTIF ICA TION , ▁ TitledBorder . DEF A ULT _ POS I TION , ▁new ▁Font ▁( ▁" Dialog ", ▁Font . BOLD , ▁12), ▁new ▁Color ▁(0, ▁102, ▁ 204 ))); ▁Grid BagConstraints ▁g ▁= ▁new ▁Grid BagConstraints ▁(); ▁g . anch or ▁= ▁Grid BagConstraints . CENTER ; ▁g . gridx ▁= ▁0; ▁g . grid y ▁= ▁0; ▁g . weight y ▁= ▁0.1 ; ▁g . grid width ▁= ▁1; ▁g . grid height ▁= ▁1; ▁g . i nsets ▁= ▁new ▁ Insets ▁(5, ▁ 5, ▁ 5, ▁ 5); ▁formNews . add ▁( new ▁JLabel ▁( ▁" Text ▁of ▁the ▁news : "), ▁g ); ▁labelCaratteri ▁= ▁new ▁JLabel ▁( ▁" # ▁Characters : ▁200 "); ▁g . gridx ▁= ▁1; ▁formNews . add ▁( label C a r atter i , ▁g ); ▁g . gridx ▁= ▁0; ▁g . grid width ▁= ▁2 ; ▁g . grid y ▁= ▁1; ▁g . weight y ▁= ▁0.3 ; ▁g . fill ▁= ▁Grid BagConstraints . VERTICAL ; ▁JScrollPane ▁scrollTesto ▁= ▁new ▁JScrollPane ▁( get TestoNews ▁()); ▁scrollTesto ▁ . ▁ setVertical Scroll Bar P olic y ▁( JScrollPane . VERTICAL _ SC ROLL BAR _ AL WA YS ); ▁formNews . add ▁( scroll Testo , ▁g ); ▁g . weight y ▁= ▁0.1 ; ▁g . grid y ▁= ▁2 ; ▁g . fill ▁= ▁Grid BagConstraints . NONE ; ▁formNews . add ▁( new ▁JLabel ▁( ▁" Priority : "), ▁g ); ▁g . grid y ▁= ▁3; ▁formNews . add ▁( getP rSlider ▁(), ▁g ); ▁New ▁JPanel ▁= ▁new ▁JPanel ▁( new ▁Flow Layout ▁()); ▁nuovo . add ▁( new ▁JLabel ▁( ▁" Length ▁of ▁news ▁ :" )); ▁durataNews ▁= ▁new ▁JComboBox ▁(); ▁for ▁( int ▁i ▁= ▁0; ▁i ▁<= ▁60 ; ▁i ▁+ ▁+) ▁( ▁durataNews . addItem ▁( ▁"" ▁+ ▁i ); ▁) ▁durataNews . s etSelectedIndex ▁(0) ; ▁durataNews . setEditable ▁( false ); ▁durataNews . setName ▁( ▁" d u ration "); ▁durataNews . addMouse Listener ▁( newsHelp ); ▁nuovo . add ▁( d urataNews ); ▁nuovo . add ▁( new ▁JLabel ▁( ▁" days ") ); ▁g . grid y ▁= ▁4 ; ▁g . fill ▁= ▁Grid BagConstraints . HORIZONTAL ; ▁formNews . add ▁( new , ▁g ); ▁g . grid width ▁= ▁1; ▁g . grid y ▁= ▁5 ; ▁formNews . add ▁( getBtn InsertModify ▁(), ▁g ); ▁g . gridx ▁= ▁1; ▁formNews . add ▁( getBtnReset ▁(), ▁g ); ▁) ▁formNews ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁s lider ▁to ▁set ▁the ▁priority ▁of ▁a ▁* ▁News . ▁* ▁* ▁@ ▁Return ▁java x . swing . JSlider ▁- ▁the ▁s lider ▁with ▁tick s ▁from ▁1 ▁to ▁5 . ▁* ▁/ ▁P rivate ▁ JSlider ▁getP rSlider ▁() ▁( ▁if ▁( null ▁== ▁prSlider ) ▁( ▁prSlider ▁= ▁new ▁ JSlider ▁( JSlider . HORIZONTAL , ▁ 5, ▁ 1); ▁prSlider . setMinimum ▁( 1); ▁prSlider . setM aximum ▁( 5); ▁prSlider . setM a j or Tick S pac ing ▁( 1); ▁prSlider . set Label Table ▁( p rSlider . create Standard Label s ▁(1) ); ▁prSlider . set Cursor ▁( Cursor . getP redefined Cursor ▁( Cursor . H AND _ CU RSO R )); ▁prSlider . setName ▁( ▁" pr i or ity "); ▁prSlider . addMouse Listener ▁( newsHelp ); ▁prSlider . setPaint Label s ▁( true ); ▁prSlider . setPaint Tick s ▁( true ); ▁prSlider . setPaint Tick s ▁( true ); ▁prSlider . set S na p To Tick s ▁( true ); ▁) ▁prSlider ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁radi o ▁button ▁for ▁submission ▁of ▁the ▁form ▁* ▁Insert ▁/ ▁edit . ▁* ▁* ▁@ ▁Return ▁java x . swing . JButton ▁- ▁the ▁button ▁of ▁submission ▁of ▁the ▁form . ▁* ▁/ ▁private ▁JButton ▁getBtn InsertModify ▁() ▁( ▁if ▁( null ▁== ▁btnInsertModify ) ▁( ▁btnInsertModify ▁= ▁new ▁JButton ▁(); ▁btnInsertModify . setText ▁( ▁" Insert "); ▁btnInsertModify . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" n uovaNews 16. png ▁ "))); ▁btnInsertModify . set Cursor ▁( Cursor ▁ . ▁getP redefined Cursor ▁( Cursor . H AND _ CU RSO R )); ▁btnInsertModify . setName ▁( btnInserisci ▁"); ▁btnInsertModify . addMouse Listener ▁( newsHelp ); ▁btnInsertModify . setFont ▁( new ▁Font ▁( ▁" Dialog ", ▁Font . BOLD , ▁12) ); ▁btnInsertModify . setHorizontal Text Position ▁( SwingConstants . TR A I L ING ); ▁btnInsertModify . a ddActionListener ▁( new ▁ActionListener ▁() ▁( ▁public ▁void ▁actionPerformed ▁( ActionEvent ▁pEvent ) ▁( ▁if ▁( testoNews . getText ▁() . ▁length ▁() ▁== ▁0) ▁( ▁JOptionPane . showInternal MessageDialog ▁( jContentPane , ▁" The ▁text ▁of ▁a ▁news ▁can ▁not ▁be ▁empty !" ▁" Error ▁New ▁News ", ▁JOptionPane . ERROR _ MESSAGE , ▁new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" error 32. png ▁ "))); ▁return ; ▁) ▁if ▁( idNews ! ▁= ▁-1) ▁/ ▁/ ▁We ' re ▁mak ing ▁a ▁change ▁( ▁/ ▁/ ▁Construct ion ▁of ▁the ▁dialog ▁for ▁confirmation ▁of ▁/ ▁/ ▁Edit ▁Root ▁= ▁new ▁JPanel ▁JPanel ▁( new ▁BorderLayout ▁()); ▁JLabel ▁message ▁= ▁new ▁JLabel ▁( ▁" Chang ing ▁the ▁selected ▁news ▁with " ▁+ ▁" New ▁data ? "); ▁message . setFont ▁( new ▁Font ▁( ▁" Dialog ", ▁Font . BOLD , ▁14)) ; ▁JLabel ▁alert ▁= ▁new ▁JLabel ▁( ▁" The ▁previous ▁data ▁can ▁not ▁be ▁mo re ▁reco vered . " ▁ SwingConstants . CENTER ); ▁avvis o . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" warning 16. png ▁ "))); ▁root . add ▁( message , ▁BorderLayout . NORTH ); ▁root . add ▁( n otice , ▁BorderLayout . CENTER ); ▁String ▁[] ▁options ▁= ▁( ▁" Edit ", ▁" Cancel "); ▁/ ▁/ ▁The ▁dialog ▁screen ▁appear s ▁int ▁choice ▁= ▁JOptionPane ▁ . ▁showInternal Option Dialog ▁( ▁jContentPane , ▁root ▁" Confirm ation ▁Change ▁News " ▁JOptionPane . YES _ NO _ OPTION , ▁JOptionPane . QU ESTION _ MESSAGE , ▁new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" ModificaNews 48 . png ")), ▁options , ▁options ▁[1] ); ▁/ ▁/ ▁I f ▁you ▁chose ▁to ▁confirm ▁the ▁change ▁if ▁( choice ▁== ▁JOptionPane . YES _ OPTION ) ▁( ▁TR Y ▁( ▁Date ▁ expires ▁= ▁new ▁Date ▁(); ▁scadenza . setDate ▁( scadenza . getDate ▁() ▁D urataNews . getSelectedIndex ▁+ ▁()); ▁BeanNews ▁new ▁= ▁new ▁BeanNews ▁( testoNews ▁ . ▁ getText ▁(), ▁new ▁Date ▁(), ▁expiration ▁prSlider . get Value ▁(), ▁idNews ); ▁gestioneNews . modifica News ▁( new ); ▁table Model . update News ▁( new ); ▁JOptionPane ▁ . ▁showInternal MessageDialog ▁( ▁jContentPane , ▁" The ▁news ▁has ▁be en ▁changed ▁successfully ▁selected . " ▁" News ▁changed !" ▁JOptionPane . OK _ OPTION , ▁new ▁ImageIcon ▁( ▁getClass ▁() ▁ . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" Ok 48 . png ▁ "))); ▁) ▁catch ▁( Exception ▁ex ) ▁( ▁JLabel ▁error ▁= ▁new ▁JLabel ▁( ▁"< html > ▁< h 2> ▁Un able ▁to ▁communicat e ▁with ▁the ▁server ▁eTour . ▁</ ▁h 2 >" ▁+ ▁"< h 3> ▁< u > ▁Change ▁operation ▁request ▁can ▁not ▁be ▁completed . ▁</ ▁U > ▁</ ▁h 3 >" ▁+ ▁"< p > ▁P lease ▁try ▁again ▁later . ▁</ ▁P >" ▁+ ▁"< p > ▁I f ▁the ▁error ▁ persist s , ▁p lease ▁conta ct ▁te ch n ical ▁support . ▁</ ▁P >" ▁+ ▁"< p > ▁We ▁a pologi ze ▁for ▁the ▁in convenien ce . ▁</ ▁H tml > "); ▁Err ▁= ▁new ▁ImageIcon ▁ImageIcon ▁( ▁getClass ▁() ▁ . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" Error 48 . png ") ); ▁JOptionPane . show MessageDialog ▁( JDesktopPane , ▁error , ▁" Error !" ▁JOptionPane . ERROR _ MESSAGE , ▁err ); ▁) ▁) ▁) ▁else ▁/ ▁/ ▁We ▁are ▁pos ting ▁( ▁Date ▁ expires ▁= ▁new ▁Date ▁(); ▁scadenza . setDate ▁( scadenza . getDate ▁() ▁D urataNews . getSelectedIndex ▁+ ▁()); ▁BeanNews ▁new ▁= ▁new ▁BeanNews ▁( testoNews . getText ▁(), ▁new ▁Date ▁(), ▁ma t urity , ▁prSlider . get Value ▁(), ▁33 ); ▁TR Y ▁( ▁boolean ▁ok ▁= ▁gestioneNews . inserisci News ▁( new ); ▁if ▁( ok ) ▁( ▁carica Tabella ▁(); ▁table Model . insertNew s ▁( new ); ▁JOptionPane ▁ . ▁showInternal MessageDialog ▁( ▁jContentPane , ▁" The ▁news ▁is ▁selected ▁correct ly ▁inserted ▁into ▁the ▁system . " ▁" New ▁news !" ▁JOptionPane . OK _ OPTION , ▁new ▁ImageIcon ▁( ▁getClass ▁() ▁ . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" N uovaNews 48 . png ▁ "))); ▁) ▁) ▁catch ▁( RemoteException ▁e ) ▁( ▁JLabel ▁error ▁= ▁new ▁JLabel ▁( ▁"< html > ▁< h 2> ▁Un able ▁to ▁communicat e ▁with ▁the ▁server ▁eTour . ▁</ ▁h 2 >" ▁+ ▁"< h 3> ▁< u > ▁Insert ion ▁operation ▁request ▁can ▁not ▁be ▁completed . ▁</ ▁U > ▁</ ▁h 3 >" ▁+ ▁"< p > ▁P lease ▁try ▁again ▁later . ▁</ ▁P >" ▁+ ▁"< p > ▁I f ▁the ▁error ▁ persist s , ▁p lease ▁conta ct ▁te ch n ical ▁support . ▁</ ▁P >" ▁+ ▁"< p > ▁We ▁a pologi ze ▁for ▁the ▁in convenien ce . ▁</ ▁H tml > "); ▁Err ▁= ▁new ▁ImageIcon ▁ImageIcon ▁( getClass ▁() ▁ . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" error 48 . png ") ); ▁JOptionPane . show MessageDialog ▁( JDesktopPane , ▁error , ▁" Error !" ▁JOptionPane . ERROR _ MESSAGE , ▁err ); ▁) ▁) ▁table Model . fir eTable Data Changed ▁(); ▁azzera Form ▁(); ▁) ▁) ); ▁) ▁btnInsertModify ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁button ▁to ▁clear ▁the ▁form ▁or ▁* ▁ Cancel ▁editing ▁action s ▁on ▁a ▁selected ▁news . ▁* ▁* ▁@ ▁Return ▁java x . swing . JButton ▁- ▁the ▁button ▁above . ▁* ▁/ ▁private ▁JButton ▁ getBtnReset ▁() ▁( ▁if ▁( null ▁== ▁btnReset ) ▁( ▁btnReset ▁= ▁new ▁JButton ▁(); ▁btnReset . setText ▁( ▁" Clear "); ▁btnReset . setHorizontal Text Position ▁( SwingConstants . LE AD ING ); ▁btnReset . setPreferredSize ▁( new ▁Dimension ▁( 103, ▁26)) ; ▁btnReset . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" azzera 16. png ▁ "))); ▁btnReset . set Cursor ▁( Cursor . getP redefined Cursor ▁( Cursor . H AND _ CU RSO R )); ▁btnReset . setName ▁( btnAzzera ▁"); ▁btnReset . addMouse Listener ▁( newsHelp ); ▁btnReset . a ddActionListener ▁( new ▁ActionListener ▁() ▁( ▁public ▁void ▁actionPerformed ▁( ActionEvent ▁arg 0) ▁( ▁azzera Form ▁(); ▁) ▁) ); ▁) ▁btnReset ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁panel ' s ▁online ▁help . ▁* ▁* ▁@ ▁Return ▁java x . swing . JPanel ▁* ▁/ ▁private ▁JPanel ▁get PanelHelp ▁() ▁( ▁if ▁( null ▁== ▁panelHelp ) ▁( ▁panelHelp ▁= ▁new ▁JPanel ▁(); ▁panelHelp . setLayout ▁( new ▁BorderLayout ▁()); ▁panelHelp . set Border ▁( BorderFactory . create TitledBorder ▁( BorderFactory ▁ . ▁create Line Border ▁( new ▁Color ▁(51, ▁102, ▁255) , ▁3), ▁" Help ", ▁ TitledBorder . DEF A ULT _ JUSTIF ICA TION , ▁ TitledBorder . DEF A ULT _ POS I TION , ▁new ▁Font ▁( ▁" Dialog ", ▁Font . BOLD , ▁12), ▁new ▁Color ▁(0, ▁102, ▁ 204 ))); ▁textGuida . setEditable ▁( false ); ▁textGuida . setContent Type ▁( ▁" text ▁/ ▁html "); ▁textGuida . setOp aque ▁( false ); ▁textGuida ▁ . ▁setText ▁( ▁"< html > ▁M ove ▁you r ▁mouse ▁point er ▁ over ▁a ▁control " ▁+ ▁" Of ▁interest ▁to ▁display ▁the ▁con text - sen sitive ▁help . ▁</ ▁H tml > "); ▁textGuida . setName ▁( textGuida ▁"); ▁textGuida . addMouse Listener ▁( newsHelp ); ▁panelHelp . setPreferredSize ( new ▁Dimension ( 200 , ▁100) ); ▁panelHelp . add ▁( textGuida , ▁BorderLayout . CENTER ); ▁) ▁panelHelp ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁table ▁with ▁all ▁the ▁news ▁the se ▁* ▁In ▁the ▁system . ▁* ▁* ▁@ ▁Return ▁java x . swing . JTable ▁* ▁/ ▁private ▁JScrollPane ▁get TableNews ▁() ▁( ▁if ▁( null ▁== ▁tableNews ) ▁( ▁NewsTableModel ▁= ▁new ▁TableModel ▁(); ▁tableNews ▁= ▁new ▁ ScrollableTable ▁( TableModel ); ▁tableNews . setRow H eight ▁( 64 ); ▁tableNews . s etSelectionMode ▁( ListSelection Model . S ING LE _ SELECT ION ); ▁tableNews . setSelection Background ▁( new ▁Color ▁(0 x e 6, ▁0 x e 6, ▁0 x F A )); ▁tableNews . setColumn Selection A llowed ▁( false ); ▁ListSelection Model ▁selectionModel ▁= ▁tableNews . get SelectionModel ▁(); ▁selectionModel . add ListSelection Listener ▁( new ▁ListSelection Listener ▁() ▁( ▁public ▁void ▁Value Changed ▁( ListSelection Event ▁event ) ▁( ▁int ▁selectedRow ▁= ▁tableNews . getS electedRow ▁(); ▁btnModificaN . setEnabled ▁( ( selectedRow ! ▁= ▁-1) ? ▁true : ▁false ); ▁btnEliminaN . setEnabled ▁( ( selectedRow ! ▁= ▁-1) ? ▁true : ▁false ); ▁) ▁) ); ▁tableNews . add KeyListener ▁( new ▁Key Adapter ▁() ▁( ▁public ▁void ▁ keyPressed ▁( KeyEvent ▁PKEY ) ▁( ▁int ▁key Code ▁= ▁p Key . getKeyC ode ▁(); ▁if ▁( key Code ▁== ▁ KeyEvent . V K _ ENTER ) ▁( ▁btnModificaN . do Click ▁(); ▁) ▁else ▁if ▁( ( key Code ▁== ▁ KeyEvent . V K _ CANCEL ) ▁| ▁| ▁( Key Code ▁== ▁ KeyEvent . V K _ BACK _ SP A CE )) ▁( ▁btnEliminaN . do Click ▁(); ▁) ▁) ▁) ); ▁scrollTableNews ▁= ▁new ▁JScrollPane ▁(); ▁scrollTableNews . set Viewport View ▁( table News ); ▁scrollTableNews ▁ . ▁ setVertical Scroll Bar P olic y ▁( JScrollPane . VERTICAL _ SC ROLL BAR _ AL WA YS ); ▁) ▁scrollTableNews ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁initialize s ▁the ▁text ▁area ▁that ▁contains ▁the ▁text ▁of ▁a ▁news . ▁* ▁* ▁@ ▁Return ▁java x . swing . JTextArea ▁- ▁the ▁text ▁area . ▁* ▁/ ▁private ▁JTextArea ▁get TestoNews ▁() ▁( ▁if ▁( null ▁== ▁testoNews ) ▁( ▁testoNews ▁= ▁new ▁JTextArea ▁(); ▁testoNews . set Wrap S tyle Word ▁( true ); ▁testoNews . set Line Wrap ▁( true ); ▁testoNews . set Border ▁( BorderFactory . create Lower ed BevelBorder ▁()); ▁testoNews . setColumn s ▁(18 ); ▁testoNews . set Line Wrap ▁( true ); ▁testoNews . setRow s ▁(4) ; ▁testoNews . set Document ▁( new ▁ LimitedDocument ▁(200 )); ▁testoNews . setName ▁( ▁" text "); ▁testoNews . addMouse Listener ▁( newsHelp ); ▁testoNews . add KeyListener ▁( new ▁Key Adapter ▁() ▁( ▁public ▁void ▁ keyTyped ▁( KeyEvent ▁pKeyEvent ) ▁( ▁ keyChar ▁pKeyEvent . get Key Char ▁= ▁char ▁(); ▁if ▁( Char act er . is D igi t ▁( keyChar ) ▁| ▁| ▁Character . is L et t er ▁( keyChar ) ▁| ▁| ▁Character . is White space ▁( keyChar )) ▁( ▁int ▁len ▁= ▁testoNews . getText ▁() . ▁length ▁(); ▁if ▁( len ! ▁= ▁200) ▁( ▁labelCaratteri ▁ . ▁setText ▁( ▁" # ▁Characters " ▁+ ▁(200 ▁- ▁( testoNews . getText ▁() ▁ . ▁length ▁() ▁+ ▁1) )); ▁) ▁) ▁) ▁public ▁void ▁ keyPressed ▁( KeyEvent ▁pKeyEvent ) ▁( ▁int ▁key Code ▁= ▁pKeyEvent . getKeyC ode ▁(); ▁if ▁( key Code ▁== ▁ KeyEvent . V K _ CANCEL ▁| ▁| ▁Key Code ▁== ▁ KeyEvent . V K _ BACK _ SP A CE ) ▁( ▁int ▁len ▁= ▁testoNews . getText ▁() . ▁length ▁(); ▁if ▁( len ! ▁= ▁0) ▁( ▁labelCaratteri . setText ▁( ▁" # ▁Characters " ▁+ ▁(200 ▁- ▁len ▁+ ▁1) ); ▁) ▁) ▁) ▁) ); ▁) ▁testoNews ▁return ; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁reset s ▁the ▁form ▁fields . ▁* ▁/ ▁private ▁void ▁azzera Form ▁() ▁( ▁btnInsertModify . setText ▁( ▁" Insert "); ▁btnReset . setText ▁( ▁" Clear "); ▁btnReset . setIcon ▁( new ▁ImageIcon ▁( getClass ▁() . ▁getRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" azzera 16. png ▁ "))); ▁formNews . set Border ▁( BorderFactory . create TitledBorder ▁( BorderFactory ▁ . ▁create Line Border ▁( new ▁Color ▁(51, ▁102, ▁255) , ▁3), ▁" New ▁News " ▁ TitledBorder . DEF A ULT _ JUSTIF ICA TION , ▁ TitledBorder . DEF A ULT _ POS I TION , ▁new ▁Font ▁( ▁" Dialog ", ▁Font . BOLD , ▁12), ▁new ▁Color ▁(0, ▁102, ▁ 204 ))); ▁durataNews . s etSelectedIndex ▁(0) ; ▁testoNews . setText ▁( ""); ▁tableNews . clear Selection ▁(); ▁prSlider . setValue ▁( 1); ▁labelCaratteri . setText ▁( ▁" # ▁Characters : ▁200 "); ▁idNews ▁= ▁ -1; ▁) ▁/ ▁** ▁* ▁ This ▁method ▁import s ▁the ▁news ▁ down loaded ▁from ▁the ▁server ▁in ▁the ▁table . ▁* ▁/ ▁private ▁void ▁carica Tabella ▁() ▁( ▁ArrayList ▁< BeanNews > ▁news ▁= ▁null ; ▁TR Y ▁( ▁gestioneNews . ottieni All News ▁news ▁= ▁(); ▁) ▁/ ▁/ ▁I f ▁an ▁error ▁display s ▁an ▁error ▁message . ▁catch ▁( RemoteException ▁e ) ▁( ▁JLabel ▁error ▁= ▁new ▁JLabel ▁( ▁"< html > ▁< h 2> ▁Un able ▁to ▁communicat e ▁with ▁the ▁server ▁eTour . ▁</ ▁h 2 >" ▁+ ▁" The ▁list ▁of ▁< h 3> ▁< u > ▁News ▁is ▁not ▁loaded . ▁</ ▁U > ▁</ ▁h 3 >" ▁+ ▁"< p > ▁P lease ▁try ▁again ▁later . ▁</ ▁P >" ▁+ ▁"< p > ▁I f ▁the ▁error ▁ persist s , ▁p lease ▁conta ct ▁te ch n ical ▁support . ▁</ ▁P >" ▁+ ▁"< p > ▁We ▁a pologi ze ▁for ▁the ▁in convenien ce . ▁</ ▁H tml > "); ▁Err ▁= ▁new ▁ImageIcon ▁ImageIcon ▁( getClass ▁() . ▁GetRe source ▁( ▁ Home . URL _ IMAGES ▁+ ▁" error 48 . png ") ); ▁JOptionPane . showInternal MessageDialog ▁( this , ▁error , ▁" Error !" ▁JOptionPane . ERROR _ MESSAGE , ▁err ); ▁) ▁finally ▁( ▁NewsTableModel ▁= ▁new ▁TableModel ▁( new s ); ▁tableNews . set Model ▁( TableModel ); ▁/ ▁/ ▁Text ▁of ▁news ▁tableNews . getColumn Model ▁() . ▁Get Column ▁(0) . ▁setPreferred W idth ▁(320 ); ▁tableNews . getColumn Model ▁() . ▁Get Column ▁(0) . ▁set CellRenderer ▁( ▁New ▁T estoNewsRenderer ▁()); ▁/ ▁/ ▁Priority ▁tableNews . getColumn Model ▁() . ▁Get Column ▁(1) . ▁setPreferred W idth ▁(100 ); ▁tableNews . getColumn Model ▁() . ▁Get Column ▁(1) . ▁set CellRenderer ▁( ▁New ▁ PrioritaRenderer ▁()); ▁/ ▁/ ▁Date ▁of ▁entry ▁tableNews . getColumn Model ▁() . ▁Get Column ▁(2) . ▁setPreferred W idth ▁(80 ); ▁/ ▁/ ▁End ▁Date ▁tableNews . getColumn Model ▁() . ▁Get Column ▁(3) . ▁setPreferred W idth ▁(80 ); ▁) ▁) ▁)